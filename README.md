# ELEC5305 ‚Äì Adaptive Hybrid Speech Denoising

> Classical speech enhancement in MATLAB with an adaptive hybrid denoiser  
> Unit: **ELEC5305 ‚Äì Audio Signal Processing**, The University of Sydney  
> Author: **Tengfei Wang (540542743)**

---

## üîó Quick Links

- üìÑ **Project report (PDF)** ‚Äì `5305 project.pdf`
- üíª **Main script** ‚Äì `main_hybrid_denoise.m`
- üìÅ **Example speech** ‚Äì `data/OSR_us_000_0031_8k.wav`
- üìÇ **Fixed example outputs** ‚Äì `examples/osr_0031/`
- üéß **Demo audio & video** ‚Äì `results/`

---

## üåü Example: OSR_us_000_0031_8k

The repository includes a complete ‚Äúclean ‚Üí noisy ‚Üí denoised‚Äù pipeline on the
Open Speech Repository sentence **OSR_us_000_0031_8k.wav**.

**Waveform comparison (clean, noisy, three methods)**

![Waveform comparison](results/comparison_waveforms.png)

The plot shows how Wiener filtering, spectral subtraction and the proposed
adaptive hybrid method behave on the same noisy mixture.

---

## 1. Project Overview

This project studies classical **single-channel speech enhancement** and
implements three methods in MATLAB:

1. **Wiener filtering** in the STFT domain.  
2. **Spectral subtraction** with simple noise tracking.  
3. **Adaptive hybrid denoiser**, which chooses between 1 and 2 using a
   frame-wise SNR indicator.

The aim is to reduce additive background noise while keeping speech natural and
intelligible. No deep learning or external models are required, so all results
are fully reproducible on a standard MATLAB installation.

Typical use cases:

- understanding how traditional enhancement algorithms work;
- generating baseline results for comparison with modern neural models;
- producing teaching examples for spectrograms, SNR evaluation and subjective
  listening tests.

---

## 2. Key Features

- ‚úÖ **Pure MATLAB implementation** ‚Äì no toolboxes beyond standard signal
  processing functions.
- ‚úÖ **Real speech recordings** ‚Äì experiments use open English speech (OSR) at
  8 kHz.
- ‚úÖ **Multiple noise types** ‚Äì white + 50 Hz hum (‚Äúwhitehum‚Äù), high-frequency
  hiss, and multi-speaker babble.
- ‚úÖ **Controlled input SNR** ‚Äì mixtures are created at 0 / 5 / 10 / 15 dB.
- ‚úÖ **Batch experiments** ‚Äì automatic sweep over noise types and SNR levels.
- ‚úÖ **Rich visualisation** ‚Äì time-waveforms, spectrograms and bar plots of SNR
  improvement.
- ‚úÖ **Audio + video demos** ‚Äì WAV files for each method and a short MP4
  denoising video.

---

## 3. Repository Structure

    elec5305-project-TengfeiWang-540542743/
      data/                      # input clean speech files (e.g. OSR_us_000_0031_8k.wav)
      results/                   # demo outputs, figures, audio, experiment CSV
        comparison_waveforms.png
        exp_whitehum_snr_improvement.png
        exp_highfreq_snr_improvement.png
        exp_babble_snr_improvement.png
        demo_denoising.mp4
        experiment_results.csv

      examples/
        osr_0031/                # fixed GitHub example (same sentence as in the report)
          input_OSR_us_000_0031_8k.wav
          noisy.wav
          wiener.wav
          spectral.wav
          hybrid.wav
          comparison_waveforms.png

      % core processing
      generate_synthetic_speech.m
      add_noise_simulation.m
      add_noise_with_snr.m
      wiener_filter_basic.m
      spectral_subtraction_basic.m
      adaptive_hybrid_filter.m
      evaluate_snr.m
      plot_results.m
      generate_demo_video.m
      main_hybrid_denoise.m

      % experiments & utilities
      run_batch_experiments.m
      plot_experiment_results.m
      play_audio_demo.m

      % documentation
      5305 project.pdf
      README.md

---

## 4. Quick Start (Single Experiment)

1. **Clone the repository**

       git clone https://github.com/TengfeiWang5305/elec5305-project-TengfeiWang-540542743.git
       cd elec5305-project-TengfeiWang-540542743

2. **Open MATLAB** and set the current folder to the repository root.

3. **Run the main script**

       main_hybrid_denoise

   This script will

   - load a speech file from `data/` (or generate synthetic speech);
   - add one or more noise types (`whitehum`, `highfreq`, `babble`);
   - run Wiener, spectral subtraction and the adaptive hybrid method;
   - compute SNR values for each output;
   - save all audio and figures into `results/`.

4. **Listen to the outputs**

   - `results/original.wav`  
   - `results/noisy.wav`  
   - `results/wiener_denoised.wav`  
   - `results/spectral_denoised.wav`  
   - `results/hybrid_denoised.wav`

---

## 5. Example Results

### 5.1 Time-domain comparison

The following figure (generated by `main_hybrid_denoise.m`) shows clean speech,
noisy mixture and all three enhancement methods for a 30-second OSR sentence:

![Waveforms ‚Äì clean vs noisy vs denoised](results/comparison_waveforms.png)

### 5.2 SNR improvement vs input SNR

Average SNR improvement across several speech files is summarised below for
three noise types. These plots are produced by `plot_experiment_results.m`.

**White + hum noise (‚Äúwhitehum‚Äù)**

![SNR improvement ‚Äì whitehum noise](results/exp_whitehum_snr_improvement.png)

**High-frequency noise**

![SNR improvement ‚Äì highfreq noise](results/exp_highfreq_snr_improvement.png)

**Babble noise**

![SNR improvement ‚Äì babble noise](results/exp_babble_snr_improvement.png)

Interpretation (short):

- spectral subtraction provides the largest SNR gain in most conditions;
- Wiener filtering is slightly more conservative but still robust;
- the hybrid method trades some raw SNR gain for smoother, less musical
  artefacts, which is often preferred perceptually.

---

## 6. Batch Experiments & Reproducibility

To reproduce the quantitative plots in the report:

1. **Run batch experiments**

       % in MATLAB
       run_batch_experiments

   This script loops over

   - multiple clean speech files in `data/`,
   - the noise types `whitehum`, `highfreq`, `babble`,
   - input SNR levels `0, 5, 10, 15 dB`.

   All results are stored in `results/experiment_results.csv`.

2. **Generate figures**

       plot_experiment_results

   This reads the CSV file and produces the three bar plots embedded above:

   - `results/exp_whitehum_snr_improvement.png`
   - `results/exp_highfreq_snr_improvement.png`
   - `results/exp_babble_snr_improvement.png`

These scripts make it easy to extend the project: new noise types or new
algorithms can be added and evaluated by following the same interface.

---

## 7. Audio & Video Demos

### 7.1 Audio comparison

The folder `examples/osr_0031/` contains a ready-to-use audio example:

- `input_OSR_us_000_0031_8k.wav` ‚Äì original clean speech  
- `noisy.wav` ‚Äì mixture with additive noise  
- `wiener.wav` ‚Äì Wiener-filtered output  
- `spectral.wav` ‚Äì spectral subtraction output  
- `hybrid.wav` ‚Äì adaptive hybrid output  

Import these files into any audio editor or DAW to perform AB listening tests.

### 7.2 Denoising video

The script `generate_demo_video.m` creates a short MP4 video that visualises
the noisy vs denoised waveform over time:

- Output file: `results/demo_denoising.mp4`  
- Can be embedded in slides or played directly from the browser.

In MATLAB:

    % after running main_hybrid_denoise once
    generate_demo_video

This video provides a quick, visual explanation of how noise is suppressed
while speech segments are preserved.

---





